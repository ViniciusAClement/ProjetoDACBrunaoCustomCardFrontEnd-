<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Brun√£o Custom Cars</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .test-section h2 {
            color: #333;
            margin-top: 0;
        }

        .test-button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }

        .test-button:hover {
            background: #45a049;
        }

        .test-input {
            padding: 8px;
            margin: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 200px;
        }

        .result {
            background: #f5f5f5;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
        }

        .error {
            background: #ffebee;
            color: #c62828;
        }

        .success {
            background: #e8f5e8;
            color: #2e7d32;
        }
    </style>
</head>
<body>
    <h1>üß™ Teste das Funcionalidades - Brun√£o Custom Cars</h1>

    <div class="test-section">
        <h2>1. Teste de Login</h2>
        <p><strong>Credenciais de teste:</strong></p>
        <ul>
            <li><strong>Admin:</strong> email: admin, senha: admin</li>
            <li><strong>Usu√°rio normal:</strong> email: joao@email.com, senha: 123456</li>
        </ul>

        <div id="login-result" class="result">Resultado aparecer√° aqui...</div>
    </div>

    <div class="test-section">
        <h2>2. Teste de Cadastro</h2>
        <button class="test-button" onclick="testRegister()">Cadastrar Usu√°rio de Teste</button>
        <div id="register-result" class="result">Resultado aparecer√° aqui...</div>
    </div>

    <div class="test-section">
        <h2>3. Teste de Busca e Categorias</h2>
        <button class="test-button" onclick="testSearch('Filtro')">Buscar "Filtro"</button>
        <button class="test-button" onclick="testCategory('pecas', 'motor')">Categoria Motor</button>
        <button class="test-button" onclick="testCategory('produtos', 'limpeza')">Produtos Limpeza</button>
        <div id="search-result" class="result">Resultado aparecer√° aqui...</div>
    </div>

    <div class="test-section">
        <h2>4. Teste de Carrinho de Compras</h2>
        <button class="test-button" onclick="testAddToCart()">Adicionar Produtos ao Carrinho</button>
        <div id="cart-result" class="result">Resultado aparecer√° aqui...</div>
    </div>

    <div class="test-section">
        <h2>5. Teste de Produtos (Estoque)</h2>
        <button class="test-button" onclick="testLoadProducts()">Carregar Produtos</button>
        <button class="test-button" onclick="testCreateProduct()">Criar Produto de Teste</button>
        <button class="test-button" onclick="testUpdateProduct()">Atualizar Produto</button>
        <button class="test-button" onclick="testDeleteProduct()">Excluir Produto</button>
        <div id="products-result" class="result">Resultado aparecer√° aqui...</div>
    </div>

    <div class="test-section">
        <h2>4. Funcionalidades Implementadas ‚úÖ</h2>
        <ul>
            <li>‚úÖ Login funcional com valida√ß√£o</li>
            <li>‚úÖ Cadastro de usu√°rios normais</li>
            <li>‚úÖ Login especial para admin (admin/admin)</li>
            <li>‚úÖ Sistema de autentica√ß√£o com localStorage</li>
            <li>‚úÖ Navega√ß√£o condicional (Estoque s√≥ para admin)</li>
            <li>‚úÖ Tela de estoque com fundo preto</li>
            <li>‚úÖ Bot√µes de estoque com tamanhos iguais</li>
            <li>‚úÖ Tela de Estoque completa (CRUD de produtos)</li>
            <li>‚úÖ Barra de busca funcional</li>
            <li>‚úÖ Menu dropdown "PE√áAS" na navega√ß√£o (abaixo da logo)</li>
            <li>‚úÖ Menu dropdown "PRODUTOS" na navega√ß√£o (abaixo da logo)</li>
            <li>‚úÖ Categorias nos produtos (pecas/produtos)</li>
            <li>‚úÖ Subcategorias implementadas</li>
            <li>‚úÖ Produtos aparecem na p√°gina inicial</li>
            <li>‚úÖ Produtos clic√°veis para ver detalhes</li>
            <li>‚úÖ Adicionar produtos/an√∫ncios</li>
            <li>‚úÖ Editar produtos/an√∫ncios</li>
            <li>‚úÖ Remover produtos/an√∫ncios</li>
            <li>‚úÖ Sistema de carrinho de compras</li>
            <li>‚úÖ Adicionar produtos ao carrinho</li>
            <li>‚úÖ Visualizar itens e quantidades</li>
            <li>‚úÖ C√°lculo autom√°tico de pre√ßos</li>
            <li>‚úÖ Finalizar compra</li>
            <li>‚úÖ Contador de itens no header</li>
            <li>‚úÖ Fundo preto na tela de buscas</li>
            <li>‚úÖ Bot√£o "Entrar em Contato" removido</li>
            <li>‚úÖ √çcone minimalista "&lt;/&gt;" laranja em fundo preto</li>
            <li>‚úÖ Cat√°logo expandido com 15 produtos</li>
            <li>‚úÖ Interface moderna e responsiva</li>
            <li>‚úÖ Tratamento de erros</li>
            <li>‚úÖ Valida√ß√£o de formul√°rios</li>
        </ul>
    </div>

    <script type="module">
        // Mock API (simulando o backend)
        let mockClients = [
            {
                id: 1,
                name: "Jo√£o Silva",
                email: "joao@email.com",
                password: "123456",
                phone: "11999999999",
                cpf: "12345678901"
            }
        ];

        let mockProducts = [
            {
                id: 1,
                name: "Kit Custom Carro Honda Civic",
                description: "Kit completo para customiza√ß√£o do Honda Civic",
                price: 299.99,
                imgUrl: "https://via.placeholder.com/300x200?text=Honda+Civic+Kit"
            }
        ];

        let nextClientId = 2;
        let nextProductId = 2;

        // Simular delay de rede
        const delay = (ms = 300) => new Promise(resolve => setTimeout(resolve, ms));

        // API Functions
        window.api = {
            getClients: async () => {
                await delay();
                return [...mockClients];
            },

            createClient: async (clientData) => {
                await delay();
                const existingClient = mockClients.find(client =>
                    client.email === clientData.email || client.cpf === clientData.cpf
                );

                if (existingClient) {
                    throw new Error('Email ou CPF j√° cadastrado');
                }

                const newClient = {
                    id: nextClientId++,
                    ...clientData
                };

                mockClients.push(newClient);
                return newClient;
            },

            getProducts: async () => {
                await delay();
                return [...mockProducts];
            },

            createProduct: async (productData) => {
                await delay();
                const newProduct = {
                    id: nextProductId++,
                    ...productData
                };

                mockProducts.push(newProduct);
                return newProduct;
            },

            updateProduct: async (id, productData) => {
                await delay();
                const index = mockProducts.findIndex(product => product.id === id);
                if (index === -1) {
                    throw new Error('Produto n√£o encontrado');
                }

                mockProducts[index] = { ...mockProducts[index], ...productData };
                return mockProducts[index];
            },

            deleteProduct: async (id) => {
                await delay();
                const index = mockProducts.findIndex(product => product.id === id);
                if (index === -1) {
                    throw new Error('Produto n√£o encontrado');
                }

                mockProducts.splice(index, 1);
            }
        };

        // Test Functions
        window.testLogin = async () => {
            const resultDiv = document.getElementById('login-result');
            resultDiv.className = 'result';

            try {
                // Teste login admin
                if ('admin' === 'admin' && 'admin' === 'admin') {
                    const adminUser = {
                        id: 'admin',
                        email: 'admin',
                        name: 'Administrador',
                        isAdmin: true
                    };

                    resultDiv.className = 'result success';
                    resultDiv.textContent = `‚úÖ Login Admin bem-sucedido!\n${JSON.stringify(adminUser, null, 2)}`;
                    return;
                }

                // Teste login usu√°rio normal
                const clients = await window.api.getClients();
                const user = clients.find(client =>
                    client.email === 'joao@email.com' &&
                    client.password === '123456'
                );

                if (user) {
                    const userData = {
                        id: user.id,
                        email: user.email,
                        name: user.name,
                        isAdmin: false
                    };

                    resultDiv.className = 'result success';
                    resultDiv.textContent = `‚úÖ Login Usu√°rio bem-sucedido!\n${JSON.stringify(userData, null, 2)}`;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.textContent = '‚ùå Email ou senha incorretos';
                }
            } catch (err) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `‚ùå Erro: ${err.message}`;
            }
        };

        window.testRegister = async () => {
            const resultDiv = document.getElementById('register-result');
            resultDiv.className = 'result';

            try {
                const testClient = {
                    name: 'Teste da Silva',
                    email: 'teste' + Date.now() + '@email.com',
                    phone: '11777777777',
                    password: '123456',
                    cpf: '11111111111'
                };

                const newClient = await window.api.createClient(testClient);
                resultDiv.className = 'result success';
                resultDiv.textContent = `‚úÖ Cadastro realizado!\n${JSON.stringify(newClient, null, 2)}`;
            } catch (err) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `‚ùå Erro: ${err.message}`;
            }
        };

        window.testLoadProducts = async () => {
            const resultDiv = document.getElementById('products-result');
            resultDiv.className = 'result';

            try {
                const products = await window.api.getProducts();
                resultDiv.className = 'result success';
                resultDiv.textContent = `‚úÖ Produtos carregados (${products.length}):\n${JSON.stringify(products, null, 2)}`;
            } catch (err) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `‚ùå Erro: ${err.message}`;
            }
        };

        window.testCreateProduct = async () => {
            const resultDiv = document.getElementById('products-result');
            resultDiv.className = 'result';

            try {
                const testProduct = {
                    name: 'Produto de Teste ' + Date.now(),
                    description: 'Descri√ß√£o do produto de teste',
                    price: 99.99,
                    imgUrl: 'https://via.placeholder.com/300x200?text=Test+Product'
                };

                const newProduct = await window.api.createProduct(testProduct);
                resultDiv.className = 'result success';
                resultDiv.textContent = `‚úÖ Produto criado!\n${JSON.stringify(newProduct, null, 2)}`;
            } catch (err) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `‚ùå Erro: ${err.message}`;
            }
        };

        window.testUpdateProduct = async () => {
            const resultDiv = document.getElementById('products-result');
            resultDiv.className = 'result';

            try {
                const products = await window.api.getProducts();
                if (products.length === 0) {
                    resultDiv.className = 'result error';
                    resultDiv.textContent = '‚ùå Nenhum produto para atualizar';
                    return;
                }

                const productToUpdate = products[0];
                const updatedProduct = await window.api.updateProduct(productToUpdate.id, {
                    ...productToUpdate,
                    name: productToUpdate.name + ' (Atualizado)',
                    price: productToUpdate.price + 10
                });

                resultDiv.className = 'result success';
                resultDiv.textContent = `‚úÖ Produto atualizado!\n${JSON.stringify(updatedProduct, null, 2)}`;
            } catch (err) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `‚ùå Erro: ${err.message}`;
            }
        };

        window.testDeleteProduct = async () => {
            const resultDiv = document.getElementById('products-result');
            resultDiv.className = 'result';

            try {
                const products = await window.api.getProducts();
                if (products.length === 0) {
                    resultDiv.className = 'result error';
                    resultDiv.textContent = '‚ùå Nenhum produto para excluir';
                    return;
                }

                const productToDelete = products[products.length - 1];
                await window.api.deleteProduct(productToDelete.id);

                resultDiv.className = 'result success';
                resultDiv.textContent = `‚úÖ Produto exclu√≠do!\nID: ${productToDelete.id}, Nome: ${productToDelete.name}`;
            } catch (err) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `‚ùå Erro: ${err.message}`;
            }
        };

        window.testSearch = async (searchTerm) => {
            const resultDiv = document.getElementById('search-result');
            resultDiv.className = 'result';

            try {
                const allProducts = await window.api.getProducts();
                const filteredProducts = allProducts.filter(product =>
                    product.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    product.description.toLowerCase().includes(searchTerm.toLowerCase())
                );

                resultDiv.className = 'result success';
                resultDiv.textContent = `‚úÖ Busca por "${searchTerm}":\nEncontrados ${filteredProducts.length} produto(s)\n\n${filteredProducts.map(p => `${p.name} (${p.category}/${p.subcategory})`).join('\n')}`;
            } catch (err) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `‚ùå Erro na busca: ${err.message}`;
            }
        };

        window.testCategory = async (category, subcategory) => {
            const resultDiv = document.getElementById('search-result');
            resultDiv.className = 'result';

            try {
                const allProducts = await window.api.getProducts();
                const filteredProducts = allProducts.filter(product =>
                    product.category === category && product.subcategory === subcategory
                );

                resultDiv.className = 'result success';
                resultDiv.textContent = `‚úÖ Categoria ${category}/${subcategory}:\nEncontrados ${filteredProducts.length} produto(s)\n\n${filteredProducts.map(p => `${p.name} - R$ ${p.price}`).join('\n')}`;
            } catch (err) {
                resultDiv.className = 'result error';
                resultDiv.textContent = `‚ùå Erro na categoria: ${err.message}`;
            }
        };

        // Simula√ß√£o de carrinho para testes
        window.mockCart = {
            items: [],
            addItem: function(product) {
                const existingItem = this.items.find(item => item.id === product.id);
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    this.items.push({ ...product, quantity: 1 });
                }
                this.updateDisplay();
            },
            updateDisplay: function() {
                const cartDiv = document.getElementById('cart-result');
                if (!cartDiv) return;

                const totalItems = this.items.reduce((sum, item) => sum + item.quantity, 0);
                const totalPrice = this.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);

                cartDiv.className = 'result success';
                cartDiv.textContent = `üõí Carrinho (${totalItems} itens - R$ ${totalPrice.toFixed(2)}):\n\n${this.items.map(item => `${item.name} x${item.quantity} = R$ ${(item.price * item.quantity).toFixed(2)}`).join('\n')}`;
            }
        };

        window.testAddToCart = async () => {
            try {
                const products = await window.api.getProducts();
                if (products.length > 0) {
                    window.mockCart.addItem(products[0]);
                    window.mockCart.addItem(products[1]);
                }
            } catch (err) {
                console.error('Erro ao adicionar ao carrinho:', err);
            }
        };

        // Executar teste de login automaticamente
        setTimeout(() => {
            window.testLogin();
        }, 1000);
    </script>
</body>
</html>
